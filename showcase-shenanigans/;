import { Routes, Route } from 'react-router-dom'
import './App.css'
import Layout from './Pages/Layout'
import Home from './Pages/Home'
import Movies from './Pages/Movies'
import ShowPage from './Pages/MovieShow'
import { user } from './utils/types'
import { useState, useEffect } from 'react'
import { jwtDecode } from 'jwt-decode'

function App() {

    const [user, setUser] = useState<user | null>(null)

    useEffect(() => {
        const token = localStorage.getItem("JWT_Token")
        if (token) {
            const decodedToken = jwtDecode(token)
            console.log(decodedToken)
            setUser({
                id: parseInt(decodedToken.sub)

            })
        }
        else {
            console.log("token not present")
        }
    }, [])


    return (
        <>
            <Routes>
                <Route path='/' element={<Layout user={user} setUser={setUser} />} >
                    <Route path="" element={<Home />} />
                    <Route path="/movies" element={<Movies />} />
                    <Route path="/movies/:id" element={<ShowPage />} />
                    <Route path="/credits" element={<h1>Credits go here</h1>} />
                </Route>
            </Routes>
        </>
    )
}

export default App
